[
  {
    "objectID": "cmexample.html#define-the-true-situation",
    "href": "cmexample.html#define-the-true-situation",
    "title": "Illustration of Cross-MANOVA with Examples",
    "section": "Define the true situation",
    "text": "Define the true situation\nCreate an indicator-style design matrix for a design with four conditions and a constant regressor.\n\nX = repmat([eye(4) ones(4, 1)], 3, 1)\n[n, q] = size(X)\n\nX =\n     1     0     0     0     1\n     0     1     0     0     1\n     0     0     1     0     1\n     0     0     0     1     1\n     1     0     0     0     1\n     0     1     0     0     1\n     0     0     1     0     1\n     0     0     0     1     1\n     1     0     0     0     1\n     0     1     0     0     1\n     0     0     1     0     1\n     0     0     0     1     1\nn =\n    12\nq =\n     5\n\n\n\nCreate patterns across two variables for the difference between conditions 1 & 2 and 3 & 4. They are identical, i.e. there is perfect pattern stability.\n\nb21 = [0 1];\nb43 = [0 1];\n\n\n\n\nCreate parameters for the five regressors across two variables.\n\nb1 = [1, 2];\nb2 = b1 + b21;\nb3 = [3, 4];\nb4 = b3 + b43;\nb5 = [5, 6];\nB = [b1; b2; b3; b4; b5]\n[q, p] = size(B)\n\nB =\n     1     2\n     1     3\n     3     4\n     3     5\n     5     6\nq =\n     5\np =\n     2\n\n\n\nDefine error covariance matrix as identity matrix.\n\nSigma = eye(p)\n\nSigma =\n     1     0\n     0     1\n\n\n\nDefine contrasts for the difference between conditions 1 & 2 and 3 & 4, used as ‘training’ (A) and ‘validation’ contrasts (B).\n\nCA = [-1 1 0 0 0]'\nCB = [0 0 -1 1 0]'\n\nCA =\n    -1\n     1\n     0\n     0\n     0\nCB =\n     0\n     0\n    -1\n     1\n     0"
  },
  {
    "objectID": "cmexample.html#compute-true-pattern-stability",
    "href": "cmexample.html#compute-true-pattern-stability",
    "title": "Illustration of Cross-MANOVA with Examples",
    "section": "Compute true pattern stability",
    "text": "Compute true pattern stability\nParameter-effect matrix B:\n\nDeltaB = CB * pinv(CB) * B\n\nDeltaB =\n         0         0\n         0         0\n         0   -0.5000\n         0    0.5000\n         0         0\n\n\n\nCross parameter-effect matrix A→B:\n\nDeltaBA = CB * pinv(CA) * B\n\nDeltaBA =\n         0         0\n         0         0\n   -0.0000   -0.5000\n    0.0000    0.5000\n         0         0\n\n\n\nOne can see that in the second expression, the effect corresponding to CA involving regressors 1 & 2 has been moved to regressors 3 & 4, thereby matching the parameter-effect matrix resulting from the first expression. (Values like -0.000 should be zero, but are not exactly due to limited numerical precision.)\nCombined ‘numerator’ of pattern stability:\n\n1/n * DeltaBA' * X' * X * DeltaB\n\nans =\n         0    0.0000\n         0    0.1250\n\n\n\nThe ‘denominator’ is the identity matrix and therefore its inverse is the identity, too, and the combined ‘numerator’ and ‘denominator’ is identical to the ‘numerator’ alone.\nThe pattern stability is:\n\nDx = trace(1/n * DeltaBA' * X' * X * DeltaB * inv(Sigma))\n\nDx =\n    0.1250\n\n\n\nBecause there is perfect pattern stability, the value of Dx is identical to the pattern distinctness D for either one of the contrasts:\n\nDeltaA = CA * pinv(CA) * B;\nDA = trace(1/n * DeltaA' * X' * X * DeltaA * inv(Sigma))\nDB = trace(1/n * DeltaB' * X' * X * DeltaB * inv(Sigma))\n\nDA =\n    0.1250\nDB =\n    0.1250\n\n\n\nThe specific value arises from the fact that these pattern distinctness values correspond to a Mahalanobis distance of 1 (length of pattern difference is 1 and error covariance matrix is identity) and the sample sizes are 3 for both conditions and 12 in total, i.e. a ratio 6/12 = 1/2 of observations contribute, combined with a factor 1/4 according to Eq. 10 of Allefeld and Haynes (2014)."
  },
  {
    "objectID": "cmexample.html#define-modified-true-situation",
    "href": "cmexample.html#define-modified-true-situation",
    "title": "Illustration of Cross-MANOVA with Examples",
    "section": "Define modified true situation",
    "text": "Define modified true situation\nCreate patterns across two variables for the difference between conditions 1 & 2 and 3 & 4. They are orthogonal, the first only involving variable 1 and the second only involving variable 2.\n\nb21 = [1 0];\nb43 = [0 1];\n\n\n\n\nCreate parameters for the five regressors across two variables.\n\nb1 = [1, 2];\nb2 = b1 + b21;\nb3 = [3, 4];\nb4 = b3 + b43;\nb5 = [5, 6];\nB = [b1; b2; b3; b4; b5]\n\nB =\n     1     2\n     2     2\n     3     4\n     3     5\n     5     6"
  },
  {
    "objectID": "cmexample.html#compute-pattern-stability",
    "href": "cmexample.html#compute-pattern-stability",
    "title": "Illustration of Cross-MANOVA with Examples",
    "section": "Compute pattern stability",
    "text": "Compute pattern stability\n\nDeltaB = CB * pinv(CB) * B\nDeltaBA = CB * pinv(CA) * B\nDx = trace(1/n * DeltaBA' * X' * X * DeltaB * inv(Sigma))\n\nDeltaB =\n         0         0\n         0         0\n         0   -0.5000\n         0    0.5000\n         0         0\nDeltaBA =\n         0         0\n         0         0\n   -0.5000   -0.0000\n    0.5000    0.0000\n         0         0\nDx =\n   5.5511e-17\n\n\n\nAs expected, the pattern stability is zero within numerical precision."
  },
  {
    "objectID": "cmexample.html#define-modified-true-situation-1",
    "href": "cmexample.html#define-modified-true-situation-1",
    "title": "Illustration of Cross-MANOVA with Examples",
    "section": "Define modified true situation",
    "text": "Define modified true situation\nModify the error covariance matrix to include a positive correlation between the two variables.\n\nSigma = [1 0.5; 0.5 1]\n\nSigma =\n    1.0000    0.5000\n    0.5000    1.0000"
  },
  {
    "objectID": "cmexample.html#compute-pattern-stability-1",
    "href": "cmexample.html#compute-pattern-stability-1",
    "title": "Illustration of Cross-MANOVA with Examples",
    "section": "Compute pattern stability",
    "text": "Compute pattern stability\n\nDx = trace(1/n * DeltaBA' * X' * X * DeltaB * inv(Sigma))\n\nDx =\n   -0.0833\n\n\n\nThe two pattern differences are orthogonal in the space of original variables. However, pattern distinctness is quantified ‘in units of the multivariate error variance’, expressed through the factor inv(Sigma), which implicitly transforms the patterns into a spatially ‘whitened’ version. In this whitened-variable space, the two patterns are no longer orthogonal.\n\n\n\n\n\n\n\n\nIn fact, after whitening the pattern differences point into partially opposite directions, reflected in a negative pattern stability.\nNote that the same effect can occur without correlation between the variables, if the two variables have different variances and the two orthogonal patterns are not aligned with the two variables.\n\nD = trace(1/n * DeltaB' * X' * X * DeltaB * inv(Sigma))\n\nD =\n    0.1667"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "MVPA by Cross-Validated (Cross-) MANOVA",
    "section": "",
    "text": "This project is under development and not yet usable.\n\nThis software is copyrighted © 2023 by Carsten Allefeld and released under the terms of the GNU General Public License, version 3 or later. With contributions by Remi Gau, Polina Iamshchinina, and Thomas Christophel.\nIt has been developed with Matlab R2022b (v9.13) and SPM12 r7771, but should work with later and possibly slightly earlier versions.\nThe software does not depend on other toolboxes, except cvCrossManovaRegion and cvCrossManovaSearchlight which depend on SPM being installed."
  },
  {
    "objectID": "reference.html",
    "href": "reference.html",
    "title": "Reference documentation",
    "section": "",
    "text": "cross-validated (cross-) MANOVA on searchlight\ncvCrossManovaSearchlight(dirName, slRadius, Cs, permute = false, lambda = 0)\n\n\n\ndirName\ndirectory where the SPM.mat file referring to an estimated model is located\n\n\nslRadius\nradius of the searchlight sphere in voxels\n\n\nanalyses\ncell array of analysis specifications\n\n\npermute\nwhether to compute permutation values\n\n\nlambda\nregularization parameter (0–1)\n\n\n\nOutput files are written to the same directory:\n\n\n\nspmD_C####_P####.nii\nimages of the pattern discriminability D, contrast and permutation are identified by numbers\n\n\nspmDs_C####_P####.nii\nimages of standardized pattern discriminability Ds\n\n\nVPSL.nii\nimage of the number of voxels for each searchlight\n\n\ncmsParameters.mat\nrecord of the analysis parameters"
  },
  {
    "objectID": "reference.html#function-cvcrossmanovasearchlight",
    "href": "reference.html#function-cvcrossmanovasearchlight",
    "title": "Reference documentation",
    "section": "",
    "text": "cross-validated (cross-) MANOVA on searchlight\ncvCrossManovaSearchlight(dirName, slRadius, Cs, permute = false, lambda = 0)\n\n\n\ndirName\ndirectory where the SPM.mat file referring to an estimated model is located\n\n\nslRadius\nradius of the searchlight sphere in voxels\n\n\nanalyses\ncell array of analysis specifications\n\n\npermute\nwhether to compute permutation values\n\n\nlambda\nregularization parameter (0–1)\n\n\n\nOutput files are written to the same directory:\n\n\n\nspmD_C####_P####.nii\nimages of the pattern discriminability D, contrast and permutation are identified by numbers\n\n\nspmDs_C####_P####.nii\nimages of standardized pattern discriminability Ds\n\n\nVPSL.nii\nimage of the number of voxels for each searchlight\n\n\ncmsParameters.mat\nrecord of the analysis parameters"
  },
  {
    "objectID": "reference.html#function-cvcrossmanovaregion",
    "href": "reference.html#function-cvcrossmanovaregion",
    "title": "Reference documentation",
    "section": "function cvCrossManovaRegion",
    "text": "function cvCrossManovaRegion\ncross-validated MANOVA on region\n[D, p] = cvCrossManovaRegion(dirName, regions, analyses, permute = false, lambda = 0)\n\n\n\ndirName\ndirectory where the SPM.mat file referring to an estimated model is located\n\n\nregions\nregion mask(s), (cell array of) logical 3D volume(s) or filename(s)\n\n\nanalyses\ncell array of analysis specifications\n\n\nlambda\nregularization parameter (0–1)\n\n\npermute\nwhether to compute permutation values\n\n\nD\npattern distinctness, contrasts × permutations × regions\n\n\np\nnumber of voxels in the region(s)"
  },
  {
    "objectID": "reference.html#class-analysis",
    "href": "reference.html#class-analysis",
    "title": "Reference documentation",
    "section": "class Analysis",
    "text": "class Analysis\ndata type representing an analysis\n\nproperties\n\n\n\nCA\n‘training’ contrast, regressors × subcontrasts\n\n\nCB\n‘validation’ contrast, regressors × subcontrasts\n\n\nsessionsA\n‘training’ sessions, folds × sessions logical array\n\n\nsessionsB\n‘validation’ sessions, folds × sessions logical array\n\n\nL\nnumber of folds\n\n\nm\nnumber of sessions\n\n\nperms\nsign permutations, permutations × sessions\n\n\n\n\n\nstatic method leaveOneSessionOut\ncreate Analysis object for leave-one-session-out cross-validation\nanalysis = Analysis.leaveOneSessionOut(m, CA, CB)\nThis is a convenience method as an alternative to calling the constructor with manually specified sessionsA and sessionsB.\n\n\nconstructor Analysis\ncreate Analysis object\nanalysis = Analysis(CA, CB, sessionsA, sessionsB)\n\n\nmethod addPermutations\nadd unique sign permutations of per-session parameter estimates\nanalysis.addPermutations(maxPerms = 1000)\nThis method adds information to analysis that sign-permutations should be applied, so that different values of D for the different permutations are computed.\n\n\n\n\n\n\nWarning\n\n\n\nSign permutations are used to test a per-subject null hypothesis of no effect in standard MANOVA analyses. It does not make sense to apply them to Cross-MANOVAs.\n\n\nFor m sessions there are formally 2m per-session sign permutations, but not all of them lead to different permutation values. The number of unique permutations depends on the ‘training’ and ‘validation’ sessions used in different folds (sessionsA, sessionsB). This method determines which permutations lead to different outcomes and makes sure only those unique permutations are performed.\nIf the number of unique permutations exceeds maxPerms, a randomly chosen subset of maxPerms is chosen (including the neutral permutation, which is always permutation 1).\n\n\nmethod disp\ntextually display information about analysis\nanalysis.disp()\nThis method overrides Matlab’s disp, so you can also use disp(analysis) or simply analysis without semicolon to get the same information.\n\n\nmethod show\ngraphically display information about analysis\nfig = analysis.show(name = \"\")\nThe method creates a figure window and returns the handle. Optionally, a name for the figure can be chosen."
  },
  {
    "objectID": "reference.html#class-cvcrossmanova",
    "href": "reference.html#class-cvcrossmanova",
    "title": "Reference documentation",
    "section": "class CvCrossManova",
    "text": "class CvCrossManova\ndata type representing data and several analyses\n\nproperties\n\n\n\nYs\ncell array of per-session design matrices\n\n\nXs\ncell array of per-session data matrices\n\n\nanalyses\ncell array of Analysis objects\n\n\nlambda\nstrength of regularization (0–1) towards Euclidean metric\n\n\nm\nnumber of sessions\n\n\nns\narray of per-session numbers of observations (rows)\n\n\nfs\narray of per-session residual degrees of freedom\n\n\nnVariables\nnumber of data variables (columns)\n\n\nhBetas\ncell array of per-session parameter estimates\n\n\nhXis\ncell array of per-session error estimates\n\n\nnAnalyses\nnumber of analyses\n\n\n\n\n\nconstructor CvCrossManova\ncreate CvCrossManova object\nCvCrossManova(Ys, Xs, analyses, lambda=, fs=)\n\n\n\nXs\ncell array of per-session design matrices\n\n\nYs\ncell array of per-session data matrices\n\n\nanalyses\ncell array of Analysis objects\n\n\nlambda\nstrength of regularization (0–1) towards Euclidean metric, default: 1e-8\n\n\nfs\narray of per-session residual degrees of freedom, default: computed from size and rank of design matrices\n\n\n\nUpon creation, a CvCrossManova object stores data matrices, design matrices, analysis definitions, and further parameters, and it estimates GLM parameters and errors. Actual analyses are then performed on subsets of variables by calling the method runAnalyses.\n\n\nmethod showAnalyses\ngraphically displays all defined analyses\n\n\nmethod dispAnalyses\nsummarizes all defined analyses\n\n\nmethod nResults\nreturns the number of values returned by runAnalyses\n\n\nmethod runAnalyses\nruns the defined analyses on a subset of variables\nD = runAnalyses(self, vi)\nvi variable indices, i.e. column indices into the data matrices default: all variables Ds cell array of analysis results, either pattern distinctness or pattern stability Each cell element is a scalar if no permutations have been applied, or a vector of permutation values where the first one corresponds to the neutral permutation."
  },
  {
    "objectID": "cmtest.html#define-true-situation-and-simulate-data",
    "href": "cmtest.html#define-true-situation-and-simulate-data",
    "title": "Test of Cross-MANOVA using Examples",
    "section": "Define true situation and simulate data",
    "text": "Define true situation and simulate data\nCreate patterns across two variables for the difference between conditions 1 & 2 and 3 & 4. They are identical, i.e. there is perfect pattern stability.\n\nb21 = [0 1];\nb43 = [0 1];\n\n\n\n\nDefine error covariance matrix as identity matrix.\n\nSigma = eye(2);\n\n\n\n\nDefine contrasts for the difference between conditions 1 & 2 and 3 & 4.\n\nC21 = [-1 1 0 0 0]';\nC43 = [0 0 -1 1 0]';\n\n\n\n\nWe repeat the basic design matrix in each session many times, to well estimate pattern distinctness and pattern stability.\n\nnRep = 1000;\n\n\n\n\n\nCreate an indicator-style design matrix for a design with four conditions and a constant regressor.\nCreate parameters for the five regressors across two variables.\nCreate data with four sessions, with the same design matrix and parameters.\n\n\nX = repmat([eye(4) ones(4, 1)], nRep, 1);\n[n, q] = size(X);\n\nb1 = [1, 2];\nb2 = b1 + b21;\nb3 = [3, 4];\nb4 = b3 + b43;\nb5 = [5, 6];\nB = [b1; b2; b3; b4; b5];\n[q, p] = size(B);\n\nm = 4;\nYs = cell(m, 1);\nXs = cell(m, 1);\nfor k = 1 : m\n  Ys{k} = X * B + mvnrnd(zeros(1, p), Sigma, n);\n  Xs{k} = X;\nend"
  },
  {
    "objectID": "cmtest.html#define-analyses",
    "href": "cmtest.html#define-analyses",
    "title": "Test of Cross-MANOVA using Examples",
    "section": "Define analyses",
    "text": "Define analyses\n\nA leave-one-session-out cross-validated MANOVA with contrast C21.\nA leave-one-session-out cross-validated MANOVA with contrast C43.\nA leave-one-session-out cross-validated cross-MANOVA from contrast C21 to contrast C43.\nA leave-one-session-out cross-validated cross-MANOVA from contrast C43 to contrast C21.\nA custom analysis with two folds, where in fold 1 contrast C21 is applied to the first two sessions and contrast C43 to the last two sessions, and vice versa in fold 2.\n\n\nanalysis1 = {C21};\nanalysis2 = {C43};\nanalysis3 = {C21, C43};\nanalysis4 = {C43, C21};\nanalysis5 = Analysis(C21, C43, [1 1 0 0 ; 0 0 1 1], [0 0 1 1 ; 1 1 0 0]);\nanalyses = {analysis1, analysis2, analysis3, analysis4, analysis5};\n\n\n\n\nThe custom analysis is specified as an object of class Analysis:\n\nanalysis5\n\nanalysis5 = \n  Analysis:\n    2 fold(s), 4 session(s)\n    1 permutation(s)\n    CA:     5 × 1, 1-dimensional\n    CB:     5 × 1, 1-dimensional\n    CA→CB: 1-dimensional, 100 % variance\n\n\n\nAn Analysis object has a method show which graphically displays the analysis.\n\nanalysis5.show;"
  },
  {
    "objectID": "cmtest.html#prepare-analyses",
    "href": "cmtest.html#prepare-analyses",
    "title": "Test of Cross-MANOVA using Examples",
    "section": "Prepare analyses",
    "text": "Prepare analyses\nCreate a CvCrossManova object, passing data matrices, design matrices, and analysis specifications.\n\ncm = CvCrossManova(Ys, Xs, analyses)\n\ncm = \n  CvCrossManova with properties:\n\n            Ys: {1x4 cell}\n            Xs: {1x4 cell}\n      analyses: {1x5 cell}\n        lambda: 1.0000e-08\n             m: 4\n            ns: [4000 4000 4000 4000]\n            fs: [3996 3996 3996 3996]\n    nVariables: 2\n        hBetas: {[5x2 double]  [5x2 double]  [5x2 double]  [5x2 double]}\n          hXis: {1x4 cell}\n     nAnalyses: 5\n\n\n\nInternally, it converts all analysis specifications into Analysis objects.\n\ncm.analyses\n\nans =\n  1x5 cell array\n  Columns 1 through 4\n    {1x1 Analysis}    {1x1 Analysis}    {1x1 Analysis}    {1x1 Analysis}\n  Column 5\n    {1x1 Analysis}\n\n\n\nAnalysis details can be listed textually or graphically.\n\ncm.dispAnalyses\n\n  Analysis:\n    4 fold(s), 4 session(s)\n    1 permutation(s)\n    CA:     5 × 1, 1-dimensional\n  Analysis:\n    4 fold(s), 4 session(s)\n    1 permutation(s)\n    CA:     5 × 1, 1-dimensional\n  Analysis:\n    4 fold(s), 4 session(s)\n    1 permutation(s)\n    CA:     5 × 1, 1-dimensional\n    CB:     5 × 1, 1-dimensional\n    CA→CB: 1-dimensional, 100 % variance\n  Analysis:\n    4 fold(s), 4 session(s)\n    1 permutation(s)\n    CA:     5 × 1, 1-dimensional\n    CB:     5 × 1, 1-dimensional\n    CA→CB: 1-dimensional, 100 % variance\n  Analysis:\n    2 fold(s), 4 session(s)\n    1 permutation(s)\n    CA:     5 × 1, 1-dimensional\n    CB:     5 × 1, 1-dimensional\n    CA→CB: 1-dimensional, 100 % variance\n\n\n\n\ncm.showAnalyses"
  },
  {
    "objectID": "cmtest.html#run-analyses",
    "href": "cmtest.html#run-analyses",
    "title": "Test of Cross-MANOVA using Examples",
    "section": "Run analyses",
    "text": "Run analyses\n\ncm.runAnalyses()\n\nans =\n  1x5 cell array\n    {[0.1282]}    {[0.1311]}    {[0.1297]}    {[0.1297]}    {[0.1299]}\n\n\n\nThe true values for the five analyses are:\n\npattern distinctness 0.125\npattern distinctness 0.125\npattern stability 0.125\npattern stability 0.125\npattern stability 0.125"
  },
  {
    "objectID": "cmtest.html#define-modified-true-situation-and-simulate-data",
    "href": "cmtest.html#define-modified-true-situation-and-simulate-data",
    "title": "Test of Cross-MANOVA using Examples",
    "section": "Define modified true situation and simulate data",
    "text": "Define modified true situation and simulate data\nCreate patterns across two variables for the difference between conditions 1 & 2 and 3 & 4. They are orthogonal, the first only involving variable 1 and the second only involving variable 2.\n\nb21 = [1 0];\nb43 = [0 1];\n\n\n\n\n\nX = repmat([eye(4) ones(4, 1)], nRep, 1);\n[n, q] = size(X);\n\nb1 = [1, 2];\nb2 = b1 + b21;\nb3 = [3, 4];\nb4 = b3 + b43;\nb5 = [5, 6];\nB = [b1; b2; b3; b4; b5];\n[q, p] = size(B);\n\nm = 4;\nYs = cell(m, 1);\nXs = cell(m, 1);\nfor k = 1 : m\n  Ys{k} = X * B + mvnrnd(zeros(1, p), Sigma, n);\n  Xs{k} = X;\nend"
  },
  {
    "objectID": "cmtest.html#prepare-and-run-analyses",
    "href": "cmtest.html#prepare-and-run-analyses",
    "title": "Test of Cross-MANOVA using Examples",
    "section": "Prepare and run analyses",
    "text": "Prepare and run analyses\n\ncm = CvCrossManova(Ys, Xs, analyses)\ncm.runAnalyses()\n\ncm = \n  CvCrossManova with properties:\n\n            Ys: {1x4 cell}\n            Xs: {1x4 cell}\n      analyses: {1x5 cell}\n        lambda: 1.0000e-08\n             m: 4\n            ns: [4000 4000 4000 4000]\n            fs: [3996 3996 3996 3996]\n    nVariables: 2\n        hBetas: {[5x2 double]  [5x2 double]  [5x2 double]  [5x2 double]}\n          hXis: {1x4 cell}\n     nAnalyses: 5\nans =\n  1x5 cell array\n    {[0.1269]}    {[0.1218]}    {[0.0052]}    {[0.0052]}    {[0.0050]}\n\n\n\nThe true values for the five analyses are:\n\npattern distinctness 0.125\npattern distinctness 0.125\npattern stability 0\npattern stability 0\npattern stability 0"
  },
  {
    "objectID": "cmtest.html#define-modified-true-situation-and-simulate-data-1",
    "href": "cmtest.html#define-modified-true-situation-and-simulate-data-1",
    "title": "Test of Cross-MANOVA using Examples",
    "section": "Define modified true situation and simulate data",
    "text": "Define modified true situation and simulate data\nModify the error covariance matrix to include a positive correlation between the two variables.\n\nSigma = [1 0.5; 0.5 1]\n\nSigma =\n    1.0000    0.5000\n    0.5000    1.0000\n\n\n\n\nX = repmat([eye(4) ones(4, 1)], nRep, 1);\n[n, q] = size(X);\n\nb1 = [1, 2];\nb2 = b1 + b21;\nb3 = [3, 4];\nb4 = b3 + b43;\nb5 = [5, 6];\nB = [b1; b2; b3; b4; b5];\n[q, p] = size(B);\n\nm = 4;\nYs = cell(m, 1);\nXs = cell(m, 1);\nfor k = 1 : m\n  Ys{k} = X * B + mvnrnd(zeros(1, p), Sigma, n);\n  Xs{k} = X;\nend"
  },
  {
    "objectID": "cmtest.html#prepare-and-run-analyses-1",
    "href": "cmtest.html#prepare-and-run-analyses-1",
    "title": "Test of Cross-MANOVA using Examples",
    "section": "Prepare and run analyses",
    "text": "Prepare and run analyses\n\ncm = CvCrossManova(Ys, Xs, analyses)\ncm.runAnalyses()\n\ncm = \n  CvCrossManova with properties:\n\n            Ys: {1x4 cell}\n            Xs: {1x4 cell}\n      analyses: {1x5 cell}\n        lambda: 1.0000e-08\n             m: 4\n            ns: [4000 4000 4000 4000]\n            fs: [3996 3996 3996 3996]\n    nVariables: 2\n        hBetas: {[5x2 double]  [5x2 double]  [5x2 double]  [5x2 double]}\n          hXis: {1x4 cell}\n     nAnalyses: 5\nans =\n  1x5 cell array\n    {[0.1801]}    {[0.1742]}    {[-0.0922]}    {[-0.0922]}    {[-0.0922]}\n\n\n\nThe true values for the five analyses are:\n\npattern distinctness 0.1667\npattern distinctness 0.1667\npattern stability -0.0833\npattern stability -0.0833\npattern stability -0.0833"
  }
]